-- MySQL
ALTER TABLE METRIC_GROUP_REGEXS ADD COLUMN IS_BLACKLIST_REGEX BOOLEAN NOT NULL;
UPDATE METRIC_GROUP_REGEXS SET IS_BLACKLIST_REGEX = FALSE;
ALTER TABLE METRIC_GROUP_REGEXS MODIFY IS_BLACKLIST_REGEX BOOLEAN NOT NULL;
RENAME TABLE METRIC_GROUP_REGEXS TO METRIC_GROUP_REGEXES;

ALTER TABLE ALERT_SUSPENSIONS ADD COLUMN DESCRIPTION MEDIUMTEXT;
UPDATE ALERT_SUSPENSIONS SET DESCRIPTION = '';
ALTER TABLE ALERT_SUSPENSIONS MODIFY COLUMN DESCRIPTION MEDIUMTEXT NOT NULL;

ALTER TABLE ALERTS ADD COLUMN CAUTION_WINDOW_DURATION_TIME_UNIT INTEGER;
UPDATE ALERTS SET CAUTION_WINDOW_DURATION_TIME_UNIT = 74;
ALTER TABLE ALERTS ADD COLUMN DANGER_WINDOW_DURATION_TIME_UNIT INTEGER;
UPDATE ALERTS SET DANGER_WINDOW_DURATION_TIME_UNIT = 74;

ALTER TABLE ALERTS ADD COLUMN CAUTION_STOP_TRACKING_AFTER_TIME_UNIT INTEGER;
UPDATE ALERTS SET CAUTION_STOP_TRACKING_AFTER_TIME_UNIT = 74;
ALTER TABLE ALERTS ADD COLUMN DANGER_STOP_TRACKING_AFTER_TIME_UNIT INTEGER;
UPDATE ALERTS SET DANGER_STOP_TRACKING_AFTER_TIME_UNIT = 74;

ALTER TABLE ALERTS ADD COLUMN CAUTION_POSITIVE_NOTIFICATION_GROUP_ID INTEGER;
UPDATE ALERTS SET CAUTION_POSITIVE_NOTIFICATION_GROUP_ID = CAUTION_NOTIFICATION_GROUP_ID;
ALTER TABLE ALERTS ADD CONSTRAINT A_CPNGID_FK FOREIGN KEY (CAUTION_POSITIVE_NOTIFICATION_GROUP_ID) REFERENCES NOTIFICATION_GROUPS(ID);
ALTER TABLE ALERTS ADD COLUMN DANGER_POSITIVE_NOTIFICATION_GROUP_ID INTEGER;
UPDATE ALERTS SET DANGER_POSITIVE_NOTIFICATION_GROUP_ID = DANGER_NOTIFICATION_GROUP_ID;
ALTER TABLE ALERTS ADD CONSTRAINT A_DPNGID_FK FOREIGN KEY (DANGER_POSITIVE_NOTIFICATION_GROUP_ID) REFERENCES NOTIFICATION_GROUPS(ID);

ALTER TABLE ALERT_SUSPENSIONS ADD COLUMN DURATION_TIME_UNIT INTEGER;
UPDATE ALERT_SUSPENSIONS SET DURATION_TIME_UNIT = 73;
ALTER TABLE ALERT_SUSPENSIONS MODIFY COLUMN DURATION_TIME_UNIT INTEGER NOT NULL;

ALTER TABLE ALERT_SUSPENSIONS MODIFY COLUMN DURATION BIGINT NOT NULL;
UPDATE ALERT_SUSPENSIONS SET DURATION = (DURATION * 60000);



-- Apache Derby
ALTER TABLE METRIC_GROUP_REGEXS ADD COLUMN IS_BLACKLIST_REGEX BOOLEAN;
UPDATE METRIC_GROUP_REGEXS SET IS_BLACKLIST_REGEX = FALSE;
ALTER TABLE METRIC_GROUP_REGEXS ALTER COLUMN IS_BLACKLIST_REGEX NOT NULL;
RENAME TABLE METRIC_GROUP_REGEXS TO METRIC_GROUP_REGEXES;

ALTER TABLE ALERT_SUSPENSIONS ADD COLUMN DESCRIPTION CLOB(1048576);
UPDATE ALERT_SUSPENSIONS SET DESCRIPTION = '';
ALTER TABLE ALERT_SUSPENSIONS ALTER COLUMN DESCRIPTION NOT NULL;

ALTER TABLE ALERTS ADD COLUMN CAUTION_WINDOW_DURATION_TIME_UNIT INTEGER;
UPDATE ALERTS SET CAUTION_WINDOW_DURATION_TIME_UNIT = 74;
ALTER TABLE ALERTS ADD COLUMN DANGER_WINDOW_DURATION_TIME_UNIT INTEGER;
UPDATE ALERTS SET DANGER_WINDOW_DURATION_TIME_UNIT = 74;

ALTER TABLE ALERTS ADD COLUMN CAUTION_STOP_TRACKING_AFTER_TIME_UNIT INTEGER;
UPDATE ALERTS SET CAUTION_STOP_TRACKING_AFTER_TIME_UNIT = 74;
ALTER TABLE ALERTS ADD COLUMN DANGER_STOP_TRACKING_AFTER_TIME_UNIT INTEGER;
UPDATE ALERTS SET DANGER_STOP_TRACKING_AFTER_TIME_UNIT = 74;

ALTER TABLE ALERTS ADD COLUMN CAUTION_POSITIVE_NOTIFICATION_GROUP_ID INTEGER;
UPDATE ALERTS SET CAUTION_POSITIVE_NOTIFICATION_GROUP_ID = CAUTION_NOTIFICATION_GROUP_ID;
ALTER TABLE ALERTS ADD CONSTRAINT A_CPNGID_FK FOREIGN KEY (CAUTION_POSITIVE_NOTIFICATION_GROUP_ID) REFERENCES NOTIFICATION_GROUPS(ID);
ALTER TABLE ALERTS ADD COLUMN DANGER_POSITIVE_NOTIFICATION_GROUP_ID INTEGER;
UPDATE ALERTS SET DANGER_POSITIVE_NOTIFICATION_GROUP_ID = DANGER_NOTIFICATION_GROUP_ID;
ALTER TABLE ALERTS ADD CONSTRAINT A_DPNGID_FK FOREIGN KEY (DANGER_POSITIVE_NOTIFICATION_GROUP_ID) REFERENCES NOTIFICATION_GROUPS(ID);

ALTER TABLE ALERT_SUSPENSIONS ADD COLUMN DURATION_TIME_UNIT INTEGER;
UPDATE ALERT_SUSPENSIONS SET DURATION_TIME_UNIT = 73;
ALTER TABLE ALERT_SUSPENSIONS ALTER COLUMN DURATION_TIME_UNIT NOT NULL;

ALTER TABLE ALERT_SUSPENSIONS ADD COLUMN DURATION_TEMP BIGINT;
UPDATE ALERT_SUSPENSIONS SET DURATION_TEMP = DURATION;
ALTER TABLE ALERT_SUSPENSIONS DROP COLUMN DURATION;
RENAME COLUMN ALERT_SUSPENSIONS.DURATION_TEMP TO DURATION;
ALTER TABLE ALERT_SUSPENSIONS ALTER COLUMN DURATION NOT NULL;
UPDATE ALERT_SUSPENSIONS SET DURATION = (DURATION * 60000);